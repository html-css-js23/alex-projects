<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Item Identification</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple animation for the card appearing */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 flex items-center justify-center min-h-screen">

    <div id="content-container" class="w-full max-w-md mx-auto p-4">
        <!-- The content will be dynamically inserted here -->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Configuration ---
            // Add your new item and accessory information here.
            // The key is the unique part of the URL hash (e.g., '5rhp-main').
            const itemData = {
                '5rhp-main': {
                    name: 'Main 5RH Pro',
                    model: 'Baofeng Radio',
                    details: 'Blue antenna',
                    icon: 'üìª'
                },
                '5rhp-bck': {
                    name: 'Backup 5RH Pro',
                    model: 'Baofeng Radio',
                    details: 'Green antenna',
                    icon: 'üìª'
                },
                'anker-powerbank': {
                    name: 'Anker PowerBank 2USBC',
                    model: '',
                    details: 'Please email alexanderdrakeverschueren@gmail.com to return. Thank you!',
                    icon: 'üîã'
                },
                'cpl-filter-1': {
                    name: 'CPL Filter #1',
                    model: '',
                    details: 'Please email alexanderdrakeverschueren@gmail.com to return. Thank you!',
                    icon: 'üìπ'
                },
                'wallet': {
                    name: 'Grey Wallet',
                    model: '',
                    details: 'Please email alexanderdrakeverschueren@gmail.com to return. Thank you!',
                    icon: 'üíµ'
                },
                '5rhp-mainchgr': {
                    name: '5RH Pro Main Battery Charger',
                    model: 'Baofeng Radio',
                    details: 'Blue Antenna',
                    icon: 'üîå'
                },
                'radio-shldmic': {
                    name: 'Radio Shoulder Microphone',
                    model: '',
                    details: 'Over-shoulder Microphone',
                    icon: 'üéôÔ∏è'
                },
                'nfc-psw': {
                    name: 'nfc',
                    model: '',
                    details: 'psw-:nfc',
                    icon: 'üè∑Ô∏è'
                }
                // Add more items here following the same format
            };

            // --- Main Display Logic Function ---
            function displayContent() {
                const contentContainer = document.getElementById('content-container');
                const fullId = window.location.hash.substring(1);
                let baseId = fullId;
                let isBattery = false;

                if (fullId.endsWith('-bat')) {
                    isBattery = true;
                    baseId = fullId.substring(0, fullId.length - 4);
                }

                const item = itemData[baseId];
                let htmlContent = '';

                if (item) {
                    // An item matching the ID was found
                    let title = `${item.name} ${item.model}`.trim();
                    let description = item.details;
                    let icon = item.icon;

                    if (isBattery) {
                        title = `Battery Pack`;
                        description = `For the ${item.name} ${item.model}`;
                        icon = 'üîã'; // Override icon for batteries
                    }

                    htmlContent = `
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 text-center fade-in">
                            <div class="text-6xl mb-4">${icon}</div>
                            <h1 class="text-2xl font-bold text-gray-900 dark:text-white">${title}</h1>
                            <p class="text-gray-600 dark:text-gray-400 mt-2">${description}</p>
                        </div>
                    `;

                } else {
                    // This block handles cases where no valid item was found.
                    if (fullId) {
                        // A hash exists in the URL, but it's not a valid one.
                        htmlContent = `
                            <div class="bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 px-4 py-3 rounded-xl shadow-lg text-center fade-in" role="alert">
                                <div class="text-6xl mb-4">üö´</div>
                                <strong class="font-bold text-xl">Invalid ID!</strong>
                                <p class="block sm:inline mt-2">This NFC tag ID is not recognized. You will be redirected to the home page in 10 seconds.</p>
                            </div>
                        `;
                        // Redirect to the home page (URL without the hash) after 10 seconds
                        setTimeout(() => {
                            window.location.href = window.location.pathname;
                        }, 10000);

                    } else {
                        // No hash was in the URL, show the default welcome page.
                        const isIPhone = /iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
                        const isAndroidWithNFC = 'NDEFReader' in window;

                        let instructions = 'Please scan an NFC tag to identify an item.';
                        let scanButtonHTML = '';

                        if (isIPhone) {
                            instructions = 'To identify an item, please tap the NFC tag with your iPhone to see its details.';
                        } else if (isAndroidWithNFC) {
                            instructions = 'Tap the button below and hold your phone near an NFC tag to identify an item.';
                            scanButtonHTML = `<button id="scanButton" class="mt-6 inline-block bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors text-lg">Scan NFC Tag</button>`;
                        }

                        htmlContent = `
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 text-center fade-in">
                                <div class="text-6xl mb-4">üì±</div>
                                <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Item Identification System</h1>
                                <p class="text-gray-600 dark:text-gray-400 mt-2">
                                   ${instructions}
                                </p>
                                ${scanButtonHTML}
                                <p id="nfc-status" class="text-sm text-gray-500 mt-4 h-4"></p>
                            </div>
                        `;
                    }
                }
                
                // Insert the generated HTML into the container
                contentContainer.innerHTML = htmlContent;

                // If the scan button was added, attach the event listener
                const scanButton = document.getElementById('scanButton');
                if (scanButton) {
                    scanButton.addEventListener('click', scanNFC);
                }
            }

            // --- Web NFC Scan Function (for Android) ---
            async function scanNFC() {
                const statusEl = document.getElementById('nfc-status');
                if (!('NDEFReader' in window)) {
                    statusEl.textContent = "Web NFC is not supported on this browser.";
                    return;
                }

                try {
                    const ndef = new NDEFReader();
                    statusEl.textContent = "Bring an NFC tag near your phone...";
                    await ndef.scan();
                    
                    ndef.addEventListener("reading", ({ message }) => {
                        const record = message.records[0];
                        const textDecoder = new TextDecoder(record.encoding);
                        const id = textDecoder.decode(record.data);
                        
                        statusEl.textContent = `Tag Read! ID: ${id}`;
                        // The NFC tag should contain just the ID, e.g., "5rhp-main"
                        // We update the hash, which will trigger the display logic.
                        window.location.hash = id;
                    });

                } catch (error) {
                    statusEl.textContent = `Error: ${error.message}`;
                    console.error("NFC Error:", error);
                }
            }

            // --- Initial Load ---
            displayContent();
            
            // --- Listen for hash changes to redisplay content ---
            window.addEventListener('hashchange', displayContent);
        });
    </script>

</body>
</html>
